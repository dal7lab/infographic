<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMG Master Class: í™˜ìë¥¼ ìœ„í•œ ì‹¬ì¸µ ì¸í„°ë™í‹°ë¸Œ ê°€ì´ë“œ</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;500;700&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --medical-blue: #0ea5e9;
            --medical-green: #10b981;
            --alert-red: #ef4444;
            --bg-dark: #030712;
            --panel-bg: rgba(17, 24, 39, 0.7);
        }
        
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background-color: var(--bg-dark); 
            color: #e2e8f0;
            overflow-x: hidden;
            margin: 0;
        }
        
        .font-tech { font-family: 'Exo 2', sans-serif; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        
        /* Glassmorphism Ultra */
        .glass-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        
        .glass-panel-light {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Neon Glows */
        .glow-text { text-shadow: 0 0 10px rgba(14, 165, 233, 0.5); }
        .glow-box { box-shadow: 0 0 20px rgba(14, 165, 233, 0.2); }
        
        /* Grid Background for Medical Feel */
        .grid-bg {
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        /* Oscilloscope Line Animation */
        .scope-line {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 3s linear infinite;
        }
        @keyframes dash { to { stroke-dashoffset: 0; } }

        canvas { display: block; }
        #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.4; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- 1. Sound Engine (Web Audio API) ---
        // ì‹¤ì œ ê·¼ì „ë„ ì†Œë¦¬ë¥¼ í•©ì„±í•˜ëŠ” ì—”ì§„
        class EMGSoundEngine {
            constructor() {
                this.ctx = null;
                this.osc = null;
                this.noise = null;
                this.gain = null;
                this.isInit = false;
            }

            init() {
                if (this.isInit) return;
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                this.ctx = new AudioContext();
                this.isInit = true;
            }

            // ì¹¨ ê·¼ì „ë„ ì†Œë¦¬ (Rain on tin roof effect)
            playEMG(intensity) {
                if (!this.isInit) this.init();
                if (this.ctx.state === 'suspended') this.ctx.resume();
                
                this.stop();

                // 1. Base Noise (Static)
                const bufferSize = this.ctx.sampleRate * 2; // 2 sec buffer
                const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1; // White noise
                }

                this.noise = this.ctx.createBufferSource();
                this.noise.buffer = buffer;
                this.noise.loop = true;

                // Filter for "popping" sound
                const filter = this.ctx.createBiquadFilter();
                filter.type = 'bandpass';
                filter.frequency.value = 500 + (intensity * 1000); // Higher pitch with intensity
                filter.Q.value = 1;

                const noiseGain = this.ctx.createGain();
                // Intensity determines volume and chaos
                noiseGain.gain.value = 0.05 + (intensity * 0.5); 

                this.noise.connect(filter);
                filter.connect(noiseGain);
                noiseGain.connect(this.ctx.destination);
                this.noise.start();

                // 2. Muscle Popping (Low frequency pulses)
                if (intensity > 0.1) {
                    this.osc = this.ctx.createOscillator();
                    this.osc.type = 'sawtooth';
                    // Random frequency modulation for realistic muscle sound
                    this.osc.frequency.setValueAtTime(20 + (intensity * 100), this.ctx.currentTime);
                    
                    const oscGain = this.ctx.createGain();
                    oscGain.gain.value = 0.1 * intensity;
                    
                    this.osc.connect(oscGain);
                    oscGain.connect(this.ctx.destination);
                    this.osc.start();
                }
            }

            stop() {
                if (this.noise) { this.noise.stop(); this.noise.disconnect(); this.noise = null; }
                if (this.osc) { this.osc.stop(); this.osc.disconnect(); this.osc = null; }
            }
        }

        const soundEngine = new EMGSoundEngine();

        // --- 2. 3D Neural Background ---
        const NeuralBackground = () => {
            const mountRef = useRef(null);
            useEffect(() => {
                const scene = new THREE.Scene();
                // scene.fog = new THREE.FogExp2(0x030712, 0.002); // Deep depth
                
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.z = 50;

                const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                mountRef.current.appendChild(renderer.domElement);

                // Create Neurons (Particles)
                const geometry = new THREE.BufferGeometry();
                const count = 1000;
                const positions = new Float32Array(count * 3);
                
                for(let i=0; i<count*3; i++) {
                    positions[i] = (Math.random() - 0.5) * 150;
                }
                geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                const material = new THREE.PointsMaterial({ size: 0.5, color: 0x0ea5e9, transparent: true, opacity: 0.8 });
                const particles = new THREE.Points(geometry, material);
                scene.add(particles);

                // Create Axons (Lines)
                const lineMaterial = new THREE.LineBasicMaterial({ color: 0x0ea5e9, transparent: true, opacity: 0.15 });
                const lineGeo = new THREE.BufferGeometry();
                // Connecting nearest neighbors logic would be here, simplified for demo
                const linePos = [];
                for(let i=0; i<200; i++) {
                    const x = (Math.random() - 0.5) * 100;
                    const y = (Math.random() - 0.5) * 100;
                    const z = (Math.random() - 0.5) * 100;
                    linePos.push(x,y,z);
                    linePos.push(x+Math.random()*10, y+Math.random()*10, z+Math.random()*10);
                }
                lineGeo.setAttribute('position', new THREE.Float32BufferAttribute(linePos, 3));
                const lines = new THREE.LineSegments(lineGeo, lineMaterial);
                scene.add(lines);

                const animate = () => {
                    requestAnimationFrame(animate);
                    particles.rotation.y += 0.0005;
                    lines.rotation.y += 0.0005;
                    
                    // Gentle wave effect
                    const time = Date.now() * 0.0005;
                    scene.rotation.z = Math.sin(time) * 0.05;
                    
                    renderer.render(scene, camera);
                };
                animate();

                const handleResize = () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                };
                window.addEventListener('resize', handleResize);
                return () => { 
                    window.removeEventListener('resize', handleResize);
                    if(mountRef.current) mountRef.current.innerHTML = '';
                };
            }, []);
            return <div ref={mountRef} id="bg-canvas" />;
        };

        // --- 3. React Components ---

        // SVG Icons
        const Icons = {
            Brain: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>,
            Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Activity: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>,
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            User: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        };

        // Navigation Bar
        const Navbar = ({ activeTab, setActiveTab }) => {
            const tabs = [
                { id: 'intro', label: '01. ê²€ì‚¬ ê°œìš”' },
                { id: 'ncs', label: '02. ì‹ ê²½ì „ë„(NCS)' },
                { id: 'emg', label: '03. ì¹¨ ê·¼ì „ë„(EMG)' },
                { id: 'analysis', label: '04. ê²°ê³¼ ë¶„ì„' },
                { id: 'safety', label: '05. ì•ˆì „/Q&A' },
            ];
            return (
                <nav className="sticky top-0 z-50 glass-panel border-b border-white/10">
                    <div className="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
                        <div className="flex items-center space-x-2">
                            <span className="text-blue-500"><Icons.Activity /></span>
                            <span className="text-xl font-bold tracking-wider font-tech">NEURO<span className="text-white">LAB</span></span>
                        </div>
                        <div className="hidden md:flex space-x-1">
                            {tabs.map(tab => (
                                <button 
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`px-4 py-2 rounded-lg text-sm transition-all duration-300 ${activeTab === tab.id ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/30' : 'text-slate-400 hover:text-white hover:bg-white/5'}`}
                                >
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </div>
                </nav>
            );
        };

        // Section 1: Intro
        const IntroSection = ({ onStart }) => (
            <div className="min-h-[80vh] flex flex-col justify-center items-center text-center px-4 animate-fade-in relative z-10">
                <div className="inline-block px-4 py-1 rounded-full border border-blue-500/30 bg-blue-500/10 text-blue-400 text-sm mb-6 tracking-[0.2em] font-tech glow-text">
                    ADVANCED MEDICAL DIAGNOSTICS
                </div>
                <h1 className="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                    ì‹ ê²½ê³„ ê±´ê°•ì˜<br/>
                    <span className="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-cyan-400 to-teal-400">ì •ë°€ ì§€ë„</span>ë¥¼ ê·¸ë¦½ë‹ˆë‹¤
                </h1>
                <p className="text-lg text-slate-400 max-w-2xl mb-10 leading-relaxed">
                    ê·¼ì „ë„ ê²€ì‚¬(EMG)ì™€ ì‹ ê²½ì „ë„ ê²€ì‚¬(NCS)ëŠ” MRIë¡œë„ ë³´ì´ì§€ ì•ŠëŠ” 
                    <span className="text-white font-semibold"> 'ì‹ ê²½ì˜ ê¸°ëŠ¥ì  ë¬¸ì œ'</span>ë¥¼ ì°¾ì•„ë‚´ëŠ” ìœ ì¼í•œ ë°©ë²•ì…ë‹ˆë‹¤.
                    <br/>ì§€ê¸ˆë¶€í„° ê·¸ ê³¼í•™ì  ì›ë¦¬ì™€ ê³¼ì •ì„ ì§ì ‘ ì‹œë®¬ë ˆì´ì…˜í•´ë³´ì„¸ìš”.
                </p>
                <button onClick={onStart} className="group relative px-8 py-4 bg-blue-600 rounded-full font-bold text-lg overflow-hidden transition-transform active:scale-95 shadow-[0_0_40px_rgba(37,99,235,0.5)]">
                    <span className="relative z-10 flex items-center">
                        ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ <span className="ml-2 group-hover:translate-x-1 transition-transform">â†’</span>
                    </span>
                    <div className="absolute inset-0 bg-gradient-to-r from-blue-600 to-cyan-500 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                </button>

                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-16 w-full max-w-4xl">
                    {[
                        { val: "30-60m", label: "í‰ê·  ì†Œìš” ì‹œê°„" },
                        { val: "No.1", label: "ì‹ ê²½ ì§„ë‹¨ í‘œì¤€" },
                        { val: "99.9%", label: "ì•ˆì „ì„± (ë¬´í•´)" },
                        { val: "0.0mm", label: "ì ˆê°œ ì—†ìŒ" }
                    ].map((stat, i) => (
                        <div key={i} className="glass-panel p-4 rounded-xl text-center">
                            <div className="text-2xl font-bold font-tech text-white mb-1">{stat.val}</div>
                            <div className="text-xs text-slate-500 uppercase tracking-wider">{stat.label}</div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // Section 2: NCS Simulation
        const NCSSection = () => {
            const [stimulating, setStimulating] = useState(false);
            const [speed, setSpeed] = useState(0); // 0 to 100
            const canvasRef = useRef(null);

            const triggerNCS = () => {
                if (stimulating) return;
                setStimulating(true);
                setSpeed(0);
                
                // Animation Logic
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 2;
                    setSpeed(progress);
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => setStimulating(false), 1000);
                    }
                }, 16); // approx 60fps
            };

            // Draw Graph Logic
            useEffect(() => {
                const ctx = canvasRef.current.getContext('2d');
                ctx.clearRect(0,0, 400, 150);
                
                // Grid
                ctx.strokeStyle = '#1e293b';
                ctx.lineWidth = 1;
                ctx.beginPath();
                for(let i=0; i<400; i+=20) { ctx.moveTo(i,0); ctx.lineTo(i,150); }
                for(let i=0; i<150; i+=20) { ctx.moveTo(0,i); ctx.lineTo(400,i); }
                ctx.stroke();

                if (speed > 0) {
                    // Draw Signal
                    ctx.beginPath();
                    ctx.strokeStyle = '#22d3ee'; // Cyan
                    ctx.lineWidth = 3;
                    
                    const startX = 20;
                    const peakX = 20 + (speed * 3); // Moves with speed
                    
                    ctx.moveTo(0, 75);
                    ctx.lineTo(peakX - 20, 75);
                    // QRS-like wave (Simulation of CMAP)
                    if (speed > 10) {
                         ctx.lineTo(peakX - 10, 100); // Down
                         ctx.lineTo(peakX, 20); // Peak Up
                         ctx.lineTo(peakX + 10, 120); // Deep Down
                         ctx.lineTo(peakX + 20, 75); // Return
                    }
                    ctx.lineTo(400, 75);
                    ctx.stroke();

                    // Glow effect
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = '#22d3ee';
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }

            }, [speed]);

            return (
                <div className="max-w-6xl mx-auto py-10 px-4">
                    <div className="grid md:grid-cols-2 gap-12">
                        <div className="space-y-6">
                            <div className="inline-block text-cyan-400 font-tech text-sm tracking-widest mb-2">STEP 01: NERVE CONDUCTION STUDY</div>
                            <h2 className="text-4xl font-bold text-white mb-4">ì „ê¸° ê³ ì†ë„ë¡œ ì ê²€ <span className="text-cyan-400">(NCS)</span></h2>
                            <p className="text-slate-300 leading-relaxed text-lg">
                                ì‹ ê²½ì€ ì „ì„ ê³¼ ê°™ìŠµë‹ˆë‹¤. í”¼ë¶€ì— íŒ¨ë“œë¥¼ ë¶™ì´ê³  ë¯¸ì„¸í•œ ì „ê¸° ìê·¹ì„ ì£¼ì–´, ì‹ í˜¸ê°€ <strong className="text-white">ì–¼ë§ˆë‚˜ ë¹¨ë¦¬(ì†ë„)</strong>, <strong className="text-white">ì–¼ë§ˆë‚˜ ë§ì´(í¬ê¸°)</strong> ì „ë‹¬ë˜ëŠ”ì§€ ì¸¡ì •í•©ë‹ˆë‹¤.
                            </p>
                            
                            <div className="glass-panel p-6 rounded-xl border-l-4 border-cyan-500">
                                <h3 className="font-bold text-white mb-2 flex items-center"><Icons.Zap className="mr-2 text-yellow-400"/>ìê·¹ ëŠë‚Œì€ ì–´ë–¤ê°€ìš”?</h3>
                                <p className="text-sm text-slate-400">
                                    ë¬¼ë¦¬ì¹˜ë£Œ ë°›ì„ ë•Œì˜ ëŠë‚Œê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤. 'ì°Œë¦¿'í•˜ë©° ê·¼ìœ¡ì´ íˆ­ íŠ€ëŠ” ê²ƒì€ ì •ìƒì´ë‹ˆ ë†€ë¼ì§€ ë§ˆì„¸ìš”. ì¸ì²´ì— ë¬´í•´í•©ë‹ˆë‹¤.
                                </p>
                            </div>

                            <button 
                                onClick={triggerNCS}
                                disabled={stimulating}
                                className={`w-full py-4 rounded-xl font-bold text-lg transition-all ${stimulating ? 'bg-slate-700 text-slate-500' : 'bg-cyan-600 hover:bg-cyan-500 text-white shadow-lg hover:shadow-cyan-500/50'}`}
                            >
                                {stimulating ? 'ì‹ í˜¸ ë¶„ì„ ì¤‘...' : 'âš¡ ì „ê¸° ìê·¹ ë³´ë‚´ê¸° (Click)'}
                            </button>
                        </div>

                        {/* Simulation View */}
                        <div className="glass-panel rounded-2xl p-6 relative overflow-hidden bg-black/50">
                            {/* Arm Graphic */}
                            <div className="h-64 relative flex items-center justify-center mb-4">
                                {/* Arm outline */}
                                <div className="w-[80%] h-24 bg-slate-800/50 rounded-full border border-slate-600 relative overflow-hidden backdrop-blur-sm">
                                    {/* Nerve Path */}
                                    <div className="absolute top-1/2 left-0 right-0 h-1 bg-slate-600 -translate-y-1/2"></div>
                                    
                                    {/* Signal Particle */}
                                    <div 
                                        className="absolute top-1/2 w-4 h-4 bg-yellow-400 rounded-full shadow-[0_0_20px_rgba(250,204,21,1)] z-10 -translate-y-1/2 transition-none"
                                        style={{ left: `${speed}%`, opacity: stimulating ? 1 : 0 }}
                                    ></div>
                                </div>
                                
                                {/* Stimulator */}
                                <div className="absolute left-[10%] top-[30%] text-center">
                                    <div className={`w-3 h-3 rounded-full mb-1 mx-auto ${stimulating ? 'bg-red-500 shadow-[0_0_10px_red]' : 'bg-slate-500'}`}></div>
                                    <span className="text-xs text-slate-400">ìê·¹ì </span>
                                </div>
                                {/* Recorder */}
                                <div className="absolute right-[10%] top-[30%] text-center">
                                    <div className="w-3 h-3 bg-green-500 rounded-full mb-1 mx-auto shadow-[0_0_10px_lime]"></div>
                                    <span className="text-xs text-slate-400">ê¸°ë¡ì </span>
                                </div>
                            </div>

                            {/* Monitor */}
                            <div className="bg-black border border-slate-700 rounded-lg p-2 relative">
                                <div className="absolute top-2 left-2 text-green-500 font-tech text-xs">MONITORING: MEDIAN NERVE</div>
                                <div className="absolute top-2 right-2 text-green-500 font-tech text-xs">
                                    {stimulating ? `LATENCY: ${(speed * 0.04).toFixed(1)} ms` : 'READY'}
                                </div>
                                <canvas ref={canvasRef} width="400" height="150" className="w-full h-full"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Section 3: EMG Simulation (The Highlight)
        const EMGSection = () => {
            const [intensity, setIntensity] = useState(0); // 0.0 to 1.0
            const [isNeedleIn, setIsNeedleIn] = useState(false);
            const canvasRef = useRef(null);
            
            // Audio Control
            useEffect(() => {
                if (isNeedleIn) {
                    soundEngine.playEMG(intensity);
                } else {
                    soundEngine.stop();
                }
                return () => soundEngine.stop();
            }, [intensity, isNeedleIn]);

            // Waveform Animation
            useEffect(() => {
                const ctx = canvasRef.current.getContext('2d');
                let frameId;

                const draw = () => {
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // Trail effect
                    ctx.fillRect(0, 0, 400, 200);

                    ctx.strokeStyle = '#10b981'; // Medical Green
                    ctx.lineWidth = 2;
                    ctx.beginPath();

                    const time = Date.now() * 0.002;
                    const amp = isNeedleIn ? (5 + intensity * 80) : 1; // Base noise vs Muscle contraction

                    for (let x = 0; x < 400; x++) {
                        // Generate complex waveform: multiple sines + random noise
                        let y = 100;
                        if (isNeedleIn) {
                            y += Math.sin(x * 0.05 + time * 5) * amp * Math.random(); 
                            // Add spikes
                            if (Math.random() > 0.9 - (intensity * 0.1)) {
                                y += (Math.random() - 0.5) * amp * 2;
                            }
                        } else {
                            y += (Math.random() - 0.5) * 2; // Flatline noise
                        }
                        
                        if (x === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                    frameId = requestAnimationFrame(draw);
                };
                draw();
                return () => cancelAnimationFrame(frameId);
            }, [intensity, isNeedleIn]);

            return (
                <div className="max-w-6xl mx-auto py-10 px-4">
                    <div className="grid md:grid-cols-2 gap-12">
                        {/* Control Panel */}
                        <div className="order-2 md:order-1 space-y-8">
                             <div className="inline-block text-green-400 font-tech text-sm tracking-widest mb-2">STEP 02: NEEDLE EMG</div>
                            <h2 className="text-4xl font-bold text-white mb-4">ê·¼ìœ¡ì˜ ì—”ì§„ ì†Œë¦¬ë¥¼ ë“£ë‹¤ <span className="text-green-400">(EMG)</span></h2>
                            
                            <div className="glass-panel p-6 rounded-xl space-y-4">
                                <div className="flex justify-between items-center">
                                    <span className="font-bold text-lg">1. ê²€ì‚¬ ì‹œì‘ (ë°”ëŠ˜ ì‚½ì…)</span>
                                    <button 
                                        onClick={() => setIsNeedleIn(!isNeedleIn)}
                                        className={`px-4 py-2 rounded-full font-bold transition-colors ${isNeedleIn ? 'bg-red-500/20 text-red-400 border border-red-500' : 'bg-slate-700 text-white hover:bg-slate-600'}`}
                                    >
                                        {isNeedleIn ? 'ë°”ëŠ˜ ì œê±°' : 'ë°”ëŠ˜ ì‚½ì…'}
                                    </button>
                                </div>
                                <p className="text-sm text-slate-400">
                                    * ì•„ì£¼ ì–‡ì€(ë¨¸ë¦¬ì¹´ë½ êµµê¸°) íŠ¹ìˆ˜ ì¹¨ì„ ê·¼ìœ¡ì— ì‚´ì§ ë„£ìŠµë‹ˆë‹¤. ì „ê¸° ìê·¹ì€ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                </p>
                            </div>

                            <div className={`glass-panel p-6 rounded-xl transition-opacity duration-500 ${isNeedleIn ? 'opacity-100' : 'opacity-30 pointer-events-none'}`}>
                                <div className="flex justify-between items-center mb-4">
                                    <span className="font-bold text-lg">2. ê·¼ìœ¡ í˜ ì£¼ê¸° (ìˆ˜ì¶•)</span>
                                    <span className="text-green-400 font-mono">FORCE: {Math.round(intensity * 100)}%</span>
                                </div>
                                <input 
                                    type="range" 
                                    min="0" max="1" step="0.01" 
                                    value={intensity}
                                    onChange={(e) => setIntensity(parseFloat(e.target.value))}
                                    className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-500"
                                />
                                <div className="flex justify-between text-xs text-slate-500 mt-2">
                                    <span>í˜ ëºŒ (Silent)</span>
                                    <span>ì•½ê°„ ìˆ˜ì¶•</span>
                                    <span>ìµœëŒ€ ìˆ˜ì¶• (Interference)</span>
                                </div>
                                <p className="text-sm text-yellow-300 mt-4">
                                    ğŸ”Š ì†Œë¦¬ë¥¼ ì¼œì„¸ìš”. ë¹—ì†Œë¦¬("íˆ¬ë‘ë‘")ê°€ ë“¤ë ¤ì•¼ ê±´ê°•í•œ ê·¼ìœ¡ì…ë‹ˆë‹¤.
                                </p>
                            </div>
                        </div>

                        {/* Monitor View */}
                        <div className="order-1 md:order-2 glass-panel rounded-2xl p-1 bg-black ring-4 ring-slate-800 relative">
                             {/* Screen Glare */}
                            <div className="absolute top-0 right-0 w-full h-full bg-gradient-to-bl from-white/5 to-transparent pointer-events-none rounded-xl"></div>
                            
                            <div className="bg-black rounded-xl overflow-hidden relative h-full flex flex-col">
                                {/* Header Info */}
                                <div className="flex justify-between px-4 py-2 border-b border-slate-800 bg-slate-900/50">
                                    <div className="text-xs text-slate-400 font-mono">MODE: NEEDLE EMG</div>
                                    <div className="text-xs text-green-500 font-mono flex items-center">
                                        <span className={`w-2 h-2 rounded-full mr-2 ${isNeedleIn ? 'bg-green-500 animate-pulse' : 'bg-red-500'}`}></span>
                                        {isNeedleIn ? 'RECORDING' : 'STANDBY'}
                                    </div>
                                </div>

                                {/* Main Graph */}
                                <canvas ref={canvasRef} width="400" height="200" className="w-full flex-grow"></canvas>
                                
                                {/* Footer Info */}
                                <div className="grid grid-cols-3 gap-px bg-slate-800 border-t border-slate-800">
                                    <div className="bg-black p-2 text-center">
                                        <div className="text-[10px] text-slate-500">AMP</div>
                                        <div className="text-green-400 font-mono text-sm">{(intensity * 5).toFixed(1)} mV</div>
                                    </div>
                                    <div className="bg-black p-2 text-center">
                                        <div className="text-[10px] text-slate-500">DUR</div>
                                        <div className="text-green-400 font-mono text-sm">12.5 ms</div>
                                    </div>
                                    <div className="bg-black p-2 text-center">
                                        <div className="text-[10px] text-slate-500">FREQ</div>
                                        <div className="text-green-400 font-mono text-sm">{Math.round(20 + intensity * 50)} Hz</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Section 4: Analysis
        const AnalysisSection = () => {
            return (
                <div className="max-w-5xl mx-auto py-10 px-4">
                    <h2 className="text-3xl font-bold text-center mb-10">ê²°ê³¼ ë¶„ì„: ë‚´ ì‹ ê²½ì€ ì–´ë–¤ ìƒíƒœì¼ê¹Œìš”?</h2>
                    
                    <div className="grid md:grid-cols-2 gap-6">
                        {/* Normal Case */}
                        <div className="glass-panel p-6 rounded-xl border-t-4 border-green-500">
                            <h3 className="text-xl font-bold mb-4 flex justify-between">
                                <span>ì •ìƒ ì†Œê²¬ (Normal)</span>
                                <span className="text-green-500 text-sm bg-green-500/10 px-2 py-1 rounded">HEALTHY</span>
                            </h3>
                            <div className="h-32 bg-black/50 rounded-lg mb-4 relative flex items-center justify-center border border-slate-700">
                                <svg viewBox="0 0 200 100" className="w-full h-full p-2">
                                    <path d="M0,50 Q20,50 40,50 L50,20 L60,80 L70,50 L200,50" fill="none" stroke="#10b981" strokeWidth="2" />
                                </svg>
                                <span className="absolute bottom-2 right-2 text-xs text-slate-500">ë¹ ë¥´ê³  ë†’ì€ íŒŒí˜•</span>
                            </div>
                            <ul className="text-sm text-slate-300 space-y-2">
                                <li className="flex items-center"><span className="w-1.5 h-1.5 bg-green-500 rounded-full mr-2"></span>ì ë³µê¸°(Latency): ì§§ìŒ (ì‹ í˜¸ ì „ë‹¬ì´ ë¹ ë¦„)</li>
                                <li className="flex items-center"><span className="w-1.5 h-1.5 bg-green-500 rounded-full mr-2"></span>ì§„í­(Amplitude): ë†’ìŒ (ì‹ ê²½ì´ íŠ¼íŠ¼í•¨)</li>
                            </ul>
                        </div>

                        {/* Abnormal Case */}
                        <div className="glass-panel p-6 rounded-xl border-t-4 border-red-500">
                            <h3 className="text-xl font-bold mb-4 flex justify-between">
                                <span>ì†ëª©í„°ë„ì¦í›„êµ° (Abnormal)</span>
                                <span className="text-red-500 text-sm bg-red-500/10 px-2 py-1 rounded">DELAYED</span>
                            </h3>
                            <div className="h-32 bg-black/50 rounded-lg mb-4 relative flex items-center justify-center border border-slate-700">
                                <svg viewBox="0 0 200 100" className="w-full h-full p-2">
                                    {/* Normal Ghost */}
                                    <path d="M0,50 Q20,50 40,50 L50,20 L60,80 L70,50 L200,50" fill="none" stroke="#334155" strokeWidth="1" strokeDasharray="4" />
                                    {/* Abnormal */}
                                    <path d="M0,50 Q40,50 80,50 L90,40 L100,60 L110,50 L200,50" fill="none" stroke="#ef4444" strokeWidth="2" />
                                </svg>
                                <span className="absolute bottom-2 right-2 text-xs text-slate-500">ëŠë¦¬ê³  ë‚®ì€ íŒŒí˜•</span>
                            </div>
                            <ul className="text-sm text-slate-300 space-y-2">
                                <li className="flex items-center"><span className="w-1.5 h-1.5 bg-red-500 rounded-full mr-2"></span>ì ë³µê¸°(Latency): <strong>ê¸¸ì–´ì§</strong> (ì‹ ê²½ì´ ëˆŒë ¤ ëŠ¦ê²Œ ë„ì°©)</li>
                                <li className="flex items-center"><span className="w-1.5 h-1.5 bg-red-500 rounded-full mr-2"></span>ì§„í­(Amplitude): ë‚®ì•„ì§ˆ ìˆ˜ ìˆìŒ (ì‹ ê²½ ì†ìƒ)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };

        // Section 5: Safety & Checklist
        const SafetySection = () => {
            const checklist = [
                { title: "ë¡œì…˜/í¬ë¦¼ ê¸ˆì§€", desc: "í”¼ë¶€ ìœ ë¶„ê¸°ëŠ” ì „ê·¹ ë¶€ì°©ì„ ë°©í•´í•©ë‹ˆë‹¤." },
                { title: "í•­ì‘ê³ ì œ ë³µìš© í™•ì¸", desc: "ì•„ìŠ¤í”¼ë¦°, ì™€íŒŒë¦° ë“±ì€ ì§€í˜ˆì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
                { title: "í¸ì•ˆí•œ ë³µì¥", desc: "íŒ”ë‹¤ë¦¬ë¥¼ ì‰½ê²Œ ê±·ì–´ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ì˜·ì´ ì¢‹ìŠµë‹ˆë‹¤." },
                { title: "ì‹¬ë°•ë™ê¸° ì—¬ë¶€", desc: "ì¸ê³µì‹¬ë°•ë™ê¸° ì‹œìˆ ìëŠ” ë°˜ë“œì‹œ ì•Œë ¤ì£¼ì„¸ìš”." }
            ];

            return (
                <div className="max-w-4xl mx-auto py-10 px-4 pb-20">
                    <div className="glass-panel p-8 rounded-2xl mb-12">
                        <h2 className="text-2xl font-bold mb-6 text-center">ê²€ì‚¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
                        <div className="grid md:grid-cols-2 gap-4">
                            {checklist.map((item, i) => (
                                <div key={i} className="flex items-start p-4 bg-slate-800/50 rounded-lg hover:bg-slate-700/50 transition">
                                    <div className="bg-blue-500/20 p-2 rounded-lg text-blue-400 mr-4">
                                        <Icons.Check />
                                    </div>
                                    <div>
                                        <h4 className="font-bold text-white">{item.title}</h4>
                                        <p className="text-sm text-slate-400 mt-1">{item.desc}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="space-y-4">
                        <h3 className="text-xl font-bold mb-4">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</h3>
                        {[
                            { q: "ë§ì´ ì•„í”ˆê°€ìš”?", a: "ì¹¨ ê·¼ì „ë„ì˜ ê²½ìš° ê·¼ìœ¡ ì£¼ì‚¬ë³´ë‹¤ í›¨ì”¬ ê°€ëŠ” ì¹¨ì„ ì‚¬ìš©í•˜ë¯€ë¡œ í†µì¦ì´ ì ìŠµë‹ˆë‹¤. 'ë»ê·¼í•œ' ëŠë‚Œ ì •ë„ì´ë©°, í˜ì„ ì«™ ë¹¼ë©´ í†µì¦ì´ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤." },
                            { q: "ê²€ì‚¬ í›„ ë¶€ì‘ìš©ì€ ì—†ë‚˜ìš”?", a: "ë“œë¬¼ê²Œ ê²€ì‚¬ ë¶€ìœ„ì— ì‘ì€ ë©ì´ ë“¤ ìˆ˜ ìˆìœ¼ë‚˜ ë©°ì¹  ë‚´ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë°”ë¡œ ì¼ìƒìƒí™œì´ ê°€ëŠ¥í•©ë‹ˆë‹¤." },
                            { q: "ê²€ì‚¬ ì‹œê°„ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?", a: "ê²€ì‚¬ ë²”ìœ„ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ ë³´í†µ 30ë¶„ì—ì„œ 1ì‹œê°„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤." }
                        ].map((faq, i) => (
                            <details key={i} className="group glass-panel rounded-lg open:bg-slate-800/80 transition">
                                <summary className="p-4 font-medium cursor-pointer flex justify-between items-center text-white">
                                    <span className="flex items-center"><span className="text-blue-500 mr-2">Q.</span> {faq.q}</span>
                                    <span className="text-slate-500 group-open:rotate-180 transition-transform">â–¼</span>
                                </summary>
                                <div className="px-4 pb-4 text-slate-400 pl-8 text-sm leading-relaxed">
                                    {faq.a}
                                </div>
                            </details>
                        ))}
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('intro');

            const renderContent = () => {
                switch(activeTab) {
                    case 'intro': return <IntroSection onStart={() => setActiveTab('ncs')} />;
                    case 'ncs': return <NCSSection />;
                    case 'emg': return <EMGSection />;
                    case 'analysis': return <AnalysisSection />;
                    case 'safety': return <SafetySection />;
                    default: return <IntroSection />;
                }
            };

            return (
                <div className="min-h-screen relative text-slate-200 selection:bg-blue-500 selection:text-white">
                    <NeuralBackground />
                    
                    {/* Content Overlay */}
                    <div className="relative z-10 grid-bg min-h-screen flex flex-col">
                        <Navbar activeTab={activeTab} setActiveTab={setActiveTab} />
                        
                        <main className="flex-grow pt-4">
                            {renderContent()}
                        </main>

                        <footer className="text-center py-8 text-xs text-slate-600 border-t border-slate-800/50 mt-10">
                            <p>Â© 2024 Advanced Medical Interactive Guide. ë³¸ ìë£ŒëŠ” í™˜ì êµìœ¡ìš©ì…ë‹ˆë‹¤.</p>
                            <p className="mt-1">Designed with Medical Precision & Care.</p>
                        </footer>
                    </div>

                    {/* Floating Help Button */}
                    <button className="fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-500 p-4 rounded-full shadow-2xl z-50 group transition-all hover:scale-110">
                        <Icons.User />
                        <div className="absolute bottom-full right-0 mb-3 w-64 p-4 bg-slate-800 rounded-xl shadow-xl text-xs text-left hidden group-hover:block border border-slate-700">
                            <h5 className="font-bold text-white mb-1">ë‹´ë‹¹ ì˜ë£Œì§„ í•œë§ˆë””</h5>
                            <p className="text-slate-300">"ê¸´ì¥í•˜ë©´ ê·¼ìœ¡ì´ ìˆ˜ì¶•í•´ ê²€ì‚¬ê°€ ë” í˜ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í¸ì•ˆí•œ ë§ˆìŒìœ¼ë¡œ ì‹¬í˜¸í¡ì„ í•˜ì‹œë©´ í›¨ì”¬ ìˆ˜ì›”í•˜ê²Œ ëë‚©ë‹ˆë‹¤."</p>
                        </div>
                    </button>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
